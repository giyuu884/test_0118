"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createStcoAtom = void 0;
const make_header_1 = require("../../../../../../boxes/webm/make-header");
const primitives_1 = require("../../../../primitives");
const createStcoAtom = (samplePositions) => {
    const chunkOffsets = [];
    let lastChunk;
    for (const sample of samplePositions) {
        if (lastChunk !== sample.chunk) {
            chunkOffsets.push(sample.offset);
        }
        lastChunk = sample.chunk;
    }
    return (0, primitives_1.addSize)((0, make_header_1.combineUint8Arrays)([
        // type
        (0, primitives_1.stringsToUint8Array)('stco'),
        // version
        new Uint8Array([0]),
        // flags
        new Uint8Array([0, 0, 0]),
        // number of entries
        (0, primitives_1.numberTo32BitUIntOrInt)(chunkOffsets.length),
        // chunk offsets
        ...chunkOffsets.map((offset) => (0, primitives_1.numberTo32BitUIntOrInt)(offset)),
    ]));
};
exports.createStcoAtom = createStcoAtom;
