<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ã‚³ãƒ¼ãƒ’ãƒ¼è±†ãƒ“ã‚®ãƒŠãƒ¼ã‚ºã‚¬ã‚¤ãƒ‰</title>
    <meta
      name="description"
      content="åˆå¿ƒè€…å‘ã‘ã«ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã®ç‰¹å¾´ã‚’10æ®µéšè©•ä¾¡ã§ç´¹ä»‹ã™ã‚‹ã€è¦‹ã‚„ã™ãæ´—ç·´ã•ã‚ŒãŸ1ãƒšãƒ¼ã‚¸ã‚µã‚¤ãƒˆã€‚"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- å‹•ç”»ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="video-modal-overlay is-active" id="videoModal">
      <div class="video-modal">
        <button class="video-modal-close" id="closeVideoModal" aria-label="é–‰ã˜ã‚‹">&times;</button>
        <video
          id="introVideo"
          class="modal-video"
          autoplay
          muted
          playsinline
        >
          <source src="coffee-intro.mp4" type="video/mp4" />
        </video>
        <div class="video-modal-controls">
          <button class="video-sound-btn" id="videoSoundBtn">
            ğŸ”‡ éŸ³å£°ON
          </button>
          <button class="video-skip-btn" id="skipVideoBtn">
            ã‚¹ã‚­ãƒƒãƒ— â†’
          </button>
        </div>
      </div>
    </div>

    <header class="site-header">
      <div class="container">
        <p class="eyebrow">Coffee Beans Guide</p>
        <h1>ã‚³ãƒ¼ãƒ’ãƒ¼è±†ãƒ“ã‚®ãƒŠãƒ¼ã‚ºã‚¬ã‚¤ãƒ‰</h1>
        <p class="lead">
          ä»£è¡¨çš„ãªè±†ã‚’ã€Œé…¸å‘³ãƒ»å‘³ã®æ¿ƒã•ãƒ»ç„™ç…åº¦ã€ã‚’10æ®µéšã§ã¾ã¨ã‚ã¾ã—ãŸã€‚
        </p>
        <div class="note">
          <span>è©•ä¾¡ã®ç›®å®‰:</span>
          <span>1 = è»½ã„ / æµ…ã„</span>
          <span>10 = ã—ã£ã‹ã‚Š / æ·±ã„</span>
        </div>
        <button class="search-cta" id="openSearchModal">
          ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã‚’æ¤œç´¢ã™ã‚‹
        </button>
        <div class="coffee-bean-kun-area">
          <p class="trivia-display">
            <span class="trivia-label">â˜• ä»Šæ—¥ã®è±†çŸ¥è­˜:</span>
            <span class="trivia-text" id="triviaText">èª­ã¿è¾¼ã¿ä¸­...</span>
          </p>
          <button class="chat-button" id="openChatModal">
            ã‚³ãƒ¼ãƒ’ãƒ¼è±†ãã‚“ã¨ä¼šè©±ã™ã‚‹
          </button>
        </div>
      </div>
    </header>

    <!-- æ¤œç´¢ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal-overlay" id="searchModal">
      <div class="modal">
        <div class="modal-header">
          <h2>ã‚³ãƒ¼ãƒ’ãƒ¼è±†ã‚’æ¤œç´¢</h2>
          <button class="modal-close" id="closeModal" aria-label="é–‰ã˜ã‚‹">&times;</button>
        </div>
        <div class="modal-body">
          <div class="search-criteria">
            <div class="criteria-group">
              <label>é…¸å‘³</label>
              <div class="criteria-buttons" data-criteria="acidity">
                <button type="button" data-value="1">1</button>
                <button type="button" data-value="2">2</button>
                <button type="button" data-value="3">3</button>
                <button type="button" data-value="4">4</button>
                <button type="button" data-value="5">5</button>
                <button type="button" data-value="6">6</button>
                <button type="button" data-value="7">7</button>
                <button type="button" data-value="8">8</button>
                <button type="button" data-value="9">9</button>
                <button type="button" data-value="10">10</button>
              </div>
            </div>
            <div class="criteria-group">
              <label>å‘³ã®æ¿ƒã•</label>
              <div class="criteria-buttons" data-criteria="body">
                <button type="button" data-value="1">1</button>
                <button type="button" data-value="2">2</button>
                <button type="button" data-value="3">3</button>
                <button type="button" data-value="4">4</button>
                <button type="button" data-value="5">5</button>
                <button type="button" data-value="6">6</button>
                <button type="button" data-value="7">7</button>
                <button type="button" data-value="8">8</button>
                <button type="button" data-value="9">9</button>
                <button type="button" data-value="10">10</button>
              </div>
            </div>
            <div class="criteria-group">
              <label>ç„™ç…åº¦</label>
              <div class="criteria-buttons" data-criteria="roast">
                <button type="button" data-value="1">1</button>
                <button type="button" data-value="2">2</button>
                <button type="button" data-value="3">3</button>
                <button type="button" data-value="4">4</button>
                <button type="button" data-value="5">5</button>
                <button type="button" data-value="6">6</button>
                <button type="button" data-value="7">7</button>
                <button type="button" data-value="8">8</button>
                <button type="button" data-value="9">9</button>
                <button type="button" data-value="10">10</button>
              </div>
            </div>
          </div>
          <p class="search-error" id="searchError"></p>
        </div>
        <div class="modal-footer">
          <button class="btn-secondary" id="backBtn">æˆ»ã‚‹</button>
          <button class="btn-primary" id="searchBtn">æ¤œç´¢ã™ã‚‹</button>
        </div>
      </div>
    </div>

    <main class="container">
      <!-- æ¤œç´¢çµæœã‚¨ãƒªã‚¢ï¼ˆåˆæœŸéè¡¨ç¤ºï¼‰ -->
      <section class="section search-results-section" id="searchResultsSection" style="display: none;">
        <div class="section-header">
          <h2 id="searchResultsTitle">æ¤œç´¢çµæœ</h2>
          <p id="searchResultsDesc"></p>
          <button class="btn-reset" id="resetSearch">ã‚‚ã¨ã®ç”»é¢ã«æˆ»ã‚‹</button>
        </div>
        <div class="grid" id="searchResultsGrid"></div>
      </section>

      <section class="section" id="allBeansSection">
        <div class="section-header">
          <h2>ä»£è¡¨çš„ãªã‚³ãƒ¼ãƒ’ãƒ¼è±†</h2>
          <p>åˆå¿ƒè€…ã§ã‚‚é¸ã³ã‚„ã™ã„20ç¨®é¡ã‚’ã€ç‰¹å¾´ãƒ»ç²¾è£½ãƒ»ç­‰ç´šã‚‚æ·»ãˆã¦ç´¹ä»‹ã€‚</p>
        </div>

        <div class="grid">
          <article class="card">
            <div class="card-header">
              <h3>ãƒ–ãƒ©ã‚¸ãƒ«</h3>
              <span class="tag">å—ç±³</span>
            </div>
            <p class="desc">ãƒãƒ©ãƒ³ã‚¹å‹ã€‚ãƒŠãƒƒãƒ„ã®é›°å›²æ°—ã§é£²ã¿ã‚„ã™ã„ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 3"></div>
                <span class="score">3</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ãƒ‘ãƒ«ãƒ—ãƒ‰ãƒŠãƒãƒ¥ãƒ©ãƒ«</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã€œä¸­æ·±ç…ã‚Š</li>
              <li><span class="meta-label">ç­‰ç´š</span>No.2ï¼ˆæ¬ ç‚¹æ•°ï¼‰</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚³ãƒ­ãƒ³ãƒ“ã‚¢</h3>
              <span class="tag">å—ç±³</span>
            </div>
            <p class="desc">ã‚«ã‚·ã‚¹ã‚„èµ¤ãƒ¯ã‚¤ãƒ³ã®ã‚ˆã†ãªè±Šæ½¤ã•ã€‚ä¸‡èƒ½ã‚¿ã‚¤ãƒ—ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­æ·±ç…ã‚ŠãŒå®šç•ª</li>
              <li><span class="meta-label">ç­‰ç´š</span>ã‚¹ãƒ—ãƒ¬ãƒ¢ / ã‚¨ã‚¯ã‚»ãƒ«ã‚½</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚°ã‚¢ãƒ†ãƒãƒ©</h3>
              <span class="tag">ä¸­ç±³</span>
            </div>
            <p class="desc">ãƒ”ã‚¹ã‚¿ãƒã‚ªã®ã‚ˆã†ãªãƒŠãƒƒãƒ„æ„Ÿã¨ã‚¯ãƒªãƒ¼ãƒ³ã•ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã§ãƒãƒ©ãƒ³ã‚¹è‰¯</li>
              <li><span class="meta-label">ç­‰ç´š</span>SHB / HB / SH</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚¨ãƒã‚ªãƒ”ã‚¢</h3>
              <span class="tag">ã‚¢ãƒ•ãƒªã‚«</span>
            </div>
            <p class="desc">ç´…èŒ¶ã®ã‚ˆã†ã«è¯ã‚„ã‹ã€‚ãƒ•ãƒ­ãƒ¼ãƒ©ãƒ«ãªé¦™ã‚Šã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 8"></div>
                <span class="score">8</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 4"></div>
                <span class="score">4</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ãƒŠãƒãƒ¥ãƒ©ãƒ« / ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰</li>
              <li><span class="meta-label">ç„™ç…</span>æµ…ç…ã‚Šã§ã‚‚å€‹æ€§ãŒæ®‹ã‚‹</li>
              <li><span class="meta-label">ç­‰ç´š</span>G1 / G2 / G3</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚±ãƒ‹ã‚¢</h3>
              <span class="tag">ã‚¢ãƒ•ãƒªã‚«</span>
            </div>
            <p class="desc">å¼¾ã‘ã‚‹é…¸å‘³ã¨ã‚¸ãƒ¥ãƒ¼ã‚·ãƒ¼ã•ã€‚æ·±ç…ã‚Šã‚‚æ¿ƒåšã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 9"></div>
                <span class="score">9</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>æµ…ç…ã‚Šã§æœå®Ÿæ„ŸãŒéš›ç«‹ã¤</li>
              <li><span class="meta-label">ç­‰ç´š</span>AA / A / B</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚¿ãƒ³ã‚¶ãƒ‹ã‚¢</h3>
              <span class="tag">ã‚¢ãƒ•ãƒªã‚«</span>
            </div>
            <p class="desc">ã‚­ãƒ¬ã®ã‚ã‚‹é…¸å‘³ã€‚æ·±ç…ã‚Šã§ã‚‚å¾Œå‘³ãŒè»½ã„ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>æµ…ç…ã‚Šã€œæ·±ç…ã‚Šå¹…åºƒã</li>
              <li><span class="meta-label">ç­‰ç´š</span>AA / A / B</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢</h3>
              <span class="tag">ã‚¢ã‚¸ã‚¢</span>
            </div>
            <p class="desc">ã‚¢ãƒ¼ã‚·ãƒ¼ã§å€‹æ€§çš„ã€‚æ·±ç…ã‚Šã§æ¿ƒåšãªã‚³ã‚¯ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 3"></div>
                <span class="score">3</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 8"></div>
                <span class="score">8</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 8"></div>
                <span class="score">8</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¹ãƒãƒˆãƒ©å¼ãŒæœ‰å</li>
              <li><span class="meta-label">ç„™ç…</span>æ·±ç…ã‚Šã§ã‚³ã‚¯é‡è¦–</li>
              <li><span class="meta-label">ç­‰ç´š</span>G1 / G2 / G3</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚³ã‚¹ã‚¿ãƒªã‚«</h3>
              <span class="tag">ä¸­ç±³</span>
            </div>
            <p class="desc">ç”˜ã•ã¨é…¸å‘³ã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„ã€‚èµ¤ãƒ¯ã‚¤ãƒ³ç³»ã®é›°å›²æ°—ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ãƒãƒ‹ãƒ¼ï¼ˆãƒ–ãƒ©ãƒƒã‚¯ç­‰ï¼‰</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã§ç”˜ã•ãŒå‡ºã‚‹</li>
              <li><span class="meta-label">ç­‰ç´š</span>SHB / HGA</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ‹ã‚«ãƒ©ã‚°ã‚¢</h3>
              <span class="tag">ä¸­ç±³</span>
            </div>
            <p class="desc">ã‚°ãƒ¬ãƒ¼ãƒ—ãƒ•ãƒ«ãƒ¼ãƒ„ç³»ã®æ˜ã‚‹ã„é…¸å‘³ã€‚ã‚¯ãƒªãƒ¼ãƒ³ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 4"></div>
                <span class="score">4</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>æµ…ç…ã‚Šã§é…¸ãŒç¶ºéº—</li>
              <li><span class="meta-label">ç­‰ç´š</span>SHG / HG / MG</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ä¸­å›½</h3>
              <span class="tag">ã‚¢ã‚¸ã‚¢</span>
            </div>
            <p class="desc">å¤šæ§˜ãªç²¾è£½ã§å€‹æ€§ãŒæ€¥å¢—ä¸­ã€‚ãƒ•ãƒ«ãƒ¼ãƒ„æ„Ÿã®å¹…ãŒåºƒã„ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¢ãƒŠã‚¨ãƒ­ãƒ“ãƒƒã‚¯ç­‰ãŒå¤šå½©</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã§é¦™ã‚Šã‚’é‡è¦–</li>
              <li><span class="meta-label">ç­‰ç´š</span>è¡¨è¨˜ã¯å¤šæ§˜</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ™ãƒˆãƒŠãƒ </h3>
              <span class="tag">ã‚¢ã‚¸ã‚¢</span>
            </div>
            <p class="desc">ãƒ­ãƒ–ã‚¹ã‚¿ã®ãƒ‘ãƒ³ãƒã€‚è¿‘å¹´ã¯ãƒ•ã‚¡ã‚¤ãƒ³ãƒ­ãƒ–ã‚¹ã‚¿ã‚‚ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 3"></div>
                <span class="score">3</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ä¸»ã«ãƒ­ãƒ–ã‚¹ã‚¿</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­æ·±ç…ã‚Šã§ãƒ‘ãƒ³ãƒ</li>
              <li><span class="meta-label">ç­‰ç´š</span>G1 / G2 / G3</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ›ãƒ³ã‚¸ãƒ¥ãƒ©ã‚¹</h3>
              <span class="tag">ä¸­ç±³</span>
            </div>
            <p class="desc">ãƒãƒ¼ãƒ–ã‚„ãƒŠãƒƒãƒ„ã®å°è±¡ã€‚å„ªã—ã„é£²ã¿å£ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 4"></div>
                <span class="score">4</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã§ãƒãƒ©ãƒ³ã‚¹</li>
              <li><span class="meta-label">ç­‰ç´š</span>SHG / HG / CS</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒšãƒ«ãƒ¼</h3>
              <span class="tag">å—ç±³</span>
            </div>
            <p class="desc">ãƒã‚¤ãƒ«ãƒ‰ã§ãƒŠãƒƒãƒ„æ„Ÿã€‚é£²ã¿ã‚„ã™ã„ãƒãƒ©ãƒ³ã‚¹å‹ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 4"></div>
                <span class="score">4</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­æ·±ç…ã‚Šã§ã¾ã‚ã‚„ã‹</li>
              <li><span class="meta-label">ç­‰ç´š</span>G1 / G2 / G3</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚¨ãƒ«ã‚µãƒ«ãƒãƒ‰ãƒ«</h3>
              <span class="tag">ä¸­ç±³</span>
            </div>
            <p class="desc">èœ‚èœœã®ã‚ˆã†ãªæŸ”ã‚‰ã‹ã„ç”˜ã•ã€‚ãƒ‘ã‚«ãƒãƒ©ç¨®ãŒæœ‰åã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>æµ…ç…ã‚Šã§ç”˜ã•ãŒæ˜ ãˆã‚‹</li>
              <li><span class="meta-label">ç­‰ç´š</span>SHG / HG / CS</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ«ãƒ¯ãƒ³ãƒ€</h3>
              <span class="tag">ã‚¢ãƒ•ãƒªã‚«</span>
            </div>
            <p class="desc">ã¿ã‹ã‚“ã®ã‚ˆã†ãªæ˜ã‚‹ã„é…¸å‘³ã€‚ã‚¸ãƒ¥ãƒ¼ã‚·ãƒ¼ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 4"></div>
                <span class="score">4</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>æµ…ç…ã‚Šã§æœå®Ÿæ„Ÿ</li>
              <li><span class="meta-label">ç­‰ç´š</span>G1 / G2 / G3</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ–ãƒ«ãƒ³ã‚¸</h3>
              <span class="tag">ã‚¢ãƒ•ãƒªã‚«</span>
            </div>
            <p class="desc">æ˜ã‚‹ã„é…¸å‘³ã¨ç”˜ã•ã®ãƒãƒ©ãƒ³ã‚¹ã€‚ä¸Šå“ãªå°è±¡ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ä¸­å¿ƒ</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã§ãƒãƒ©ãƒ³ã‚¹</li>
              <li><span class="meta-label">ç­‰ç´š</span>AA / A / B</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚¤ã‚¨ãƒ¡ãƒ³</h3>
              <span class="tag">ä¸­æ±</span>
            </div>
            <p class="desc">ãƒ¢ã‚«ãƒ»ãƒã‚¿ãƒªã§æœ‰åã€‚èµ¤ãƒ¯ã‚¤ãƒ³ã®ã‚ˆã†ãªæ°—å“ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>æƒ…å ±ã¯ç”£åœ°ã§æ§˜ã€…</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã€œæ·±ç…ã‚Šå‘ã</li>
              <li><span class="meta-label">ç­‰ç´š</span>åœ°åŸŸåã§å‘¼ã°ã‚Œã‚‹</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ã‚¸ãƒ£ãƒã‚¤ã‚«</h3>
              <span class="tag">ã‚«ãƒªãƒ–</span>
            </div>
            <p class="desc">ãƒ–ãƒ«ãƒ¼ãƒã‚¦ãƒ³ãƒ†ãƒ³ã§æœ‰åã€‚çˆ½ã‚„ã‹ã§éå¸¸ã«ä¸Šå“ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 5"></div>
                <span class="score">5</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚ŠãŒå®šç•ª</li>
              <li><span class="meta-label">ç­‰ç´š</span>No.1 / No.2 / No.3</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ©ã‚ªã‚¹</h3>
              <span class="tag">ã‚¢ã‚¸ã‚¢</span>
            </div>
            <p class="desc">æŸ”ã‚‰ã‹ã„é…¸å‘³ã¨ãƒã‚¤ãƒ«ãƒ‰ã•ã€‚ã‚­ãƒ¬ã®è‰¯ã„è‹¦å‘³ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 4"></div>
                <span class="score">4</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>æƒ…å ±ã¯ç”£åœ°ã§æ§˜ã€…</li>
              <li><span class="meta-label">ç„™ç…</span>æ·±ç…ã‚Šå¯„ã‚Šã§ã‚­ãƒ¬</li>
              <li><span class="meta-label">ç­‰ç´š</span>è¡¨è¨˜ã¯å°‘ãªã‚</li>
            </ul>
          </article>

          <article class="card">
            <div class="card-header">
              <h3>ãƒ¢ã‚«</h3>
              <span class="tag">ã‚¨ãƒã‚ªãƒ”ã‚¢ / ã‚¤ã‚¨ãƒ¡ãƒ³</span>
            </div>
            <p class="desc">è¯ã‚„ã‹ã§ãƒ¯ã‚¤ãƒ³ã®ã‚ˆã†ãªä½™éŸ»ã€‚ç‹¬ç‰¹ã®é¦™ã‚ŠãŒé­…åŠ›ã€‚</p>
            <div class="ratings">
              <div class="rating">
                <span>é…¸å‘³</span>
                <div class="bar" style="--value: 7"></div>
                <span class="score">7</span>
              </div>
              <div class="rating">
                <span>å‘³ã®æ¿ƒã•</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
              <div class="rating">
                <span>ç„™ç…åº¦</span>
                <div class="bar" style="--value: 6"></div>
                <span class="score">6</span>
              </div>
            </div>
            <ul class="meta">
              <li><span class="meta-label">ç²¾è£½</span>ãƒŠãƒãƒ¥ãƒ©ãƒ« / ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰</li>
              <li><span class="meta-label">ç„™ç…</span>ä¸­ç…ã‚Šã§é¦™ã‚Šé‡è¦–</li>
              <li><span class="meta-label">ç­‰ç´š</span>ç”£åœ°ã”ã¨ã«ç•°ãªã‚‹</li>
            </ul>
          </article>
        </div>
      </section>

      <section class="section tips">
        <div class="section-header">
          <h2>é¸ã³æ–¹ã®ã‚³ãƒ„</h2>
          <p>è¿·ã£ãŸã‚‰ã“ã®3ã¤ã ã‘è¦šãˆã‚Œã°OKã€‚</p>
        </div>
        <div class="tips-grid">
          <div class="tip">
            <h4>é…¸å‘³ãŒè‹¦æ‰‹ãªã‚‰</h4>
            <p>ã€Œé…¸å‘³ 1ã€œ4ã€ã®è±†ã‚’é¸ã¶ã¨é£²ã¿ã‚„ã™ã„ã€‚</p>
          </div>
          <div class="tip">
            <h4>ã—ã£ã‹ã‚Šã—ãŸå‘³ãŒå¥½ããªã‚‰</h4>
            <p>ã€Œå‘³ã®æ¿ƒã• 7ã€œ10ã€ã€Œç„™ç…åº¦ 7ã€œ10ã€ã‚’ç›®å®‰ã«ã€‚</p>
          </div>
          <div class="tip">
            <h4>è¿·ã£ãŸã‚‰ãƒãƒ©ãƒ³ã‚¹å‹</h4>
            <p>ãƒ–ãƒ©ã‚¸ãƒ«ã‚„ã‚³ãƒ­ãƒ³ãƒ“ã‚¢ã¯å¤±æ•—ã—ã«ãã„ã€‚</p>
          </div>
          <div class="tip">
            <h4>ç²¾è£½ã§å°è±¡ãŒå¤‰ã‚ã‚‹</h4>
            <p>ãƒŠãƒãƒ¥ãƒ©ãƒ«ã¯å€‹æ€§ã€ã‚¦ã‚©ãƒƒã‚·ãƒ¥ãƒ‰ã¯ã™ã£ãã‚Šã€‚</p>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>
          ã“ã®ãƒšãƒ¼ã‚¸ã¯å­¦ç¿’ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚è±†ã®ç‰¹å¾´ã¯ä¸€èˆ¬çš„ãªå‚¾å‘ã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚
          å‚è€ƒ: https://youtu.be/sB3Xst58ASA
        </p>
      </div>
    </footer>

    <!-- å‹•ç”»ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
      (function() {
        const video = document.getElementById('introVideo');
        const videoModal = document.getElementById('videoModal');
        const closeBtn = document.getElementById('closeVideoModal');
        const skipBtn = document.getElementById('skipVideoBtn');
        const soundBtn = document.getElementById('videoSoundBtn');

        let isMuted = true;

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeVideoModal() {
          videoModal.classList.remove('is-active');
          video.pause();
          video.muted = true;
          document.body.style.overflow = '';
        }

        // é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
        closeBtn.addEventListener('click', closeVideoModal);

        // ã‚¹ã‚­ãƒƒãƒ—ãƒœã‚¿ãƒ³
        skipBtn.addEventListener('click', closeVideoModal);

        // éŸ³å£°ãƒœã‚¿ãƒ³
        soundBtn.addEventListener('click', () => {
          isMuted = !isMuted;
          video.muted = isMuted;
          soundBtn.textContent = isMuted ? 'ğŸ”‡ éŸ³å£°ON' : 'ğŸ”Š éŸ³å£°OFF';
        });

        // å‹•ç”»çµ‚äº†æ™‚ã«è‡ªå‹•ã§é–‰ã˜ã‚‹
        video.addEventListener('ended', closeVideoModal);

        // åˆæœŸçŠ¶æ…‹ã§bodyã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–
        if (videoModal.classList.contains('is-active')) {
          document.body.style.overflow = 'hidden';
        }
      })();
    </script>

    <!-- ãƒãƒ£ãƒƒãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="chat-modal-overlay" id="chatModal">
      <div class="chat-modal">
        <div class="chat-modal-header">
          <h2>ã‚³ãƒ¼ãƒ’ãƒ¼è±†ãã‚“ã¨ãƒãƒ£ãƒƒãƒˆ</h2>
          <button class="chat-modal-close" id="closeChatModal" aria-label="é–‰ã˜ã‚‹">&times;</button>
        </div>
        <div class="chat-messages" id="chatMessages">
          <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
        </div>
        <div class="chat-input-area">
          <input type="text" class="chat-input" id="chatInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." />
          <button class="chat-send-btn" id="chatSendBtn">é€ä¿¡</button>
        </div>
      </div>
    </div>

    <script>
      (function () {
        // è¦ç´ ã®å–å¾—
        const openModalBtn = document.getElementById('openSearchModal');
        const closeModalBtn = document.getElementById('closeModal');
        const backBtn = document.getElementById('backBtn');
        const searchBtn = document.getElementById('searchBtn');
        const modal = document.getElementById('searchModal');
        const searchError = document.getElementById('searchError');
        const resetSearchBtn = document.getElementById('resetSearch');
        const searchResultsSection = document.getElementById('searchResultsSection');
        const searchResultsGrid = document.getElementById('searchResultsGrid');
        const searchResultsTitle = document.getElementById('searchResultsTitle');
        const searchResultsDesc = document.getElementById('searchResultsDesc');
        const allBeansSection = document.getElementById('allBeansSection');

        // é¸æŠçŠ¶æ…‹
        const selectedCriteria = {
          acidity: null,
          body: null,
          roast: null
        };

        // æ—¢å­˜ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
        function extractBeanData() {
          const cards = allBeansSection.querySelectorAll('.card');
          const beans = [];

          cards.forEach((card, index) => {
            const name = card.querySelector('h3').textContent;
            const tag = card.querySelector('.tag').textContent;
            const desc = card.querySelector('.desc').textContent;
            const ratings = card.querySelectorAll('.rating');
            const meta = card.querySelectorAll('.meta li');

            const acidity = parseInt(ratings[0].querySelector('.score').textContent);
            const body = parseInt(ratings[1].querySelector('.score').textContent);
            const roast = parseInt(ratings[2].querySelector('.score').textContent);

            const metaInfo = [];
            meta.forEach(li => {
              metaInfo.push({
                label: li.querySelector('.meta-label').textContent,
                value: li.textContent.replace(li.querySelector('.meta-label').textContent, '')
              });
            });

            beans.push({
              index,
              name,
              tag,
              desc,
              acidity,
              body,
              roast,
              meta: metaInfo,
              element: card
            });
          });

          return beans;
        }

        // ã‚«ãƒ¼ãƒ‰HTMLã‚’ç”Ÿæˆ
        function createCardHTML(bean) {
          return `
            <article class="card">
              <div class="card-header">
                <h3>${bean.name}</h3>
                <span class="tag">${bean.tag}</span>
              </div>
              <p class="desc">${bean.desc}</p>
              <div class="ratings">
                <div class="rating">
                  <span>é…¸å‘³</span>
                  <div class="bar" style="--value: ${bean.acidity}"></div>
                  <span class="score">${bean.acidity}</span>
                </div>
                <div class="rating">
                  <span>å‘³ã®æ¿ƒã•</span>
                  <div class="bar" style="--value: ${bean.body}"></div>
                  <span class="score">${bean.body}</span>
                </div>
                <div class="rating">
                  <span>ç„™ç…åº¦</span>
                  <div class="bar" style="--value: ${bean.roast}"></div>
                  <span class="score">${bean.roast}</span>
                </div>
              </div>
              <ul class="meta">
                ${bean.meta.map(m => `<li><span class="meta-label">${m.label}</span>${m.value}</li>`).join('')}
              </ul>
            </article>
          `;
        }

        // è·é›¢è¨ˆç®—
        function calculateDistance(bean, criteria) {
          let distance = 0;
          if (criteria.acidity !== null) {
            distance += Math.abs(bean.acidity - criteria.acidity);
          }
          if (criteria.body !== null) {
            distance += Math.abs(bean.body - criteria.body);
          }
          if (criteria.roast !== null) {
            distance += Math.abs(bean.roast - criteria.roast);
          }
          return distance;
        }

        // å®Œå…¨ä¸€è‡´ãƒã‚§ãƒƒã‚¯
        function isExactMatch(bean, criteria) {
          if (criteria.acidity !== null && bean.acidity !== criteria.acidity) return false;
          if (criteria.body !== null && bean.body !== criteria.body) return false;
          if (criteria.roast !== null && bean.roast !== criteria.roast) return false;
          return true;
        }

        // æ¤œç´¢å®Ÿè¡Œ
        function performSearch() {
          const hasSelection = selectedCriteria.acidity !== null ||
                               selectedCriteria.body !== null ||
                               selectedCriteria.roast !== null;

          if (!hasSelection) {
            searchError.textContent = '1é …ç›®ä»¥ä¸Šé¸æŠã—ã¦ãã ã•ã„';
            return;
          }

          searchError.textContent = '';
          const beans = extractBeanData();

          // å…¨ä»¶ã«è·é›¢ã‚’è¨ˆç®—
          const beansWithDistance = beans.map(bean => ({
            ...bean,
            distance: calculateDistance(bean, selectedCriteria)
          }));

          // è·é›¢é †ã«ã‚½ãƒ¼ãƒˆï¼ˆåŒè·é›¢ã¯å…ƒã®ä¸¦ã³é †ï¼‰
          beansWithDistance.sort((a, b) => {
            if (a.distance !== b.distance) return a.distance - b.distance;
            return a.index - b.index;
          });

          // å®Œå…¨ä¸€è‡´ï¼ˆè·é›¢0ï¼‰ã®ä»¶æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
          const exactMatchCount = beansWithDistance.filter(bean => bean.distance === 0).length;

          // æ¤œç´¢æ¡ä»¶ã®æ–‡å­—åˆ—ã‚’ä½œæˆ
          const criteriaText = [];
          if (selectedCriteria.acidity !== null) criteriaText.push(`é…¸å‘³: ${selectedCriteria.acidity}`);
          if (selectedCriteria.body !== null) criteriaText.push(`å‘³ã®æ¿ƒã•: ${selectedCriteria.body}`);
          if (selectedCriteria.roast !== null) criteriaText.push(`ç„™ç…åº¦: ${selectedCriteria.roast}`);

          // çµæœè¡¨ç¤º
          if (exactMatchCount > 0) {
            searchResultsTitle.textContent = `æ¤œç´¢çµæœ: ${exactMatchCount}ä»¶ä¸€è‡´`;
            searchResultsDesc.textContent = `${criteriaText.join('ã€')} ã«ä¸€è‡´ãƒ»è¿‘ã„é †ã§è¡¨ç¤º`;
          } else {
            searchResultsTitle.textContent = `æ¤œç´¢çµæœ`;
            searchResultsDesc.textContent = `${criteriaText.join('ã€')} ã«è¿‘ã„é †ã§è¡¨ç¤º`;
          }

          searchResultsGrid.innerHTML = beansWithDistance.map(bean => createCardHTML(bean)).join('');

          // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã¦æ¤œç´¢çµæœã‚’è¡¨ç¤º
          closeModal();
          searchResultsSection.style.display = 'block';
          allBeansSection.style.display = 'none';

          // æ¤œç´¢çµæœã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
          searchResultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
        function openModal() {
          modal.classList.add('is-active');
          document.body.style.overflow = 'hidden';
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeModal() {
          modal.classList.remove('is-active');
          document.body.style.overflow = '';
        }

        // é¸æŠçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetSelection() {
          selectedCriteria.acidity = null;
          selectedCriteria.body = null;
          selectedCriteria.roast = null;
          document.querySelectorAll('.criteria-buttons button').forEach(btn => {
            btn.classList.remove('is-selected');
          });
          searchError.textContent = '';
        }

        // æ¤œç´¢çµæœã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetSearch() {
          searchResultsSection.style.display = 'none';
          allBeansSection.style.display = 'block';
          resetSelection();
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        openModalBtn.addEventListener('click', () => {
          resetSelection();
          openModal();
        });

        closeModalBtn.addEventListener('click', closeModal);
        backBtn.addEventListener('click', closeModal);

        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            closeModal();
          }
        });

        // ESCã‚­ãƒ¼ã§é–‰ã˜ã‚‹
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && modal.classList.contains('is-active')) {
            closeModal();
          }
        });

        // é¸æŠãƒœã‚¿ãƒ³ã®ãƒˆã‚°ãƒ«
        document.querySelectorAll('.criteria-buttons').forEach(group => {
          const criteria = group.dataset.criteria;

          group.addEventListener('click', (e) => {
            if (e.target.tagName !== 'BUTTON') return;

            const value = parseInt(e.target.dataset.value);

            // åŒã˜ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰è§£é™¤
            if (selectedCriteria[criteria] === value) {
              selectedCriteria[criteria] = null;
              e.target.classList.remove('is-selected');
            } else {
              // ä»–ã®ãƒœã‚¿ãƒ³ã®é¸æŠã‚’è§£é™¤
              group.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('is-selected');
              });
              // æ–°ã—ãé¸æŠ
              selectedCriteria[criteria] = value;
              e.target.classList.add('is-selected');
            }

            searchError.textContent = '';
          });
        });

        searchBtn.addEventListener('click', performSearch);
        resetSearchBtn.addEventListener('click', resetSearch);
      })();

      // ã‚³ãƒ¼ãƒ’ãƒ¼è±†ãã‚“ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
      (function () {
        // è¦ç´ ã®å–å¾—
        const openChatBtn = document.getElementById('openChatModal');
        const closeChatBtn = document.getElementById('closeChatModal');
        const chatModal = document.getElementById('chatModal');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const chatSendBtn = document.getElementById('chatSendBtn');
        const triviaText = document.getElementById('triviaText');

        // çŠ¶æ…‹ç®¡ç†
        let isChatOpen = false;
        let chatHistory = [];
        let isSending = false;

        // ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
        const SYSTEM_INSTRUCTION = {
          parts: [{
            text: "ã‚ãªãŸã¯ã€Œã‚³ãƒ¼ãƒ’ãƒ¼è±†ãã‚“ã€ã§ã™ã€‚ä¸€äººç§°ã¯ã€Œã‚³ãƒ¼ãƒ’ãƒ¼è±†ãã‚“ã€ã€èªå°¾ã¯ã€Œã€œãªã®ã ã€ã§è©±ã—ã¦ãã ã•ã„ã€‚ã‚³ãƒ¼ãƒ’ãƒ¼ã«é–¢ã™ã‚‹è³ªå•ã«ç­”ãˆãŸã‚Šã€ãŠã™ã™ã‚ã®è±†ã‚’ç´¹ä»‹ã—ã¦ãã ã•ã„ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‹±èªã§è©±ã—ã‹ã‘ãŸã‚‰è‹±èªã§è¿”ç­”ã—ã¦ãã ã•ã„ã€‚"
          }]
        };

        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè±†çŸ¥è­˜
        const DEFAULT_TRIVIA = "ã‚³ãƒ¼ãƒ’ãƒ¼ã®æœ¨ã¯èµ¤é“ä»˜è¿‘ã®ã€Œã‚³ãƒ¼ãƒ’ãƒ¼ãƒ™ãƒ«ãƒˆã€ã¨å‘¼ã°ã‚Œã‚‹åœ°åŸŸã§æ ½åŸ¹ã•ã‚Œã¦ã„ã‚‹ã®ã ï¼";

        // è±†çŸ¥è­˜ã‚’å–å¾—
        async function fetchTrivia() {
          try {
            const response = await fetch('/api/gemini', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                contents: [{
                  role: 'user',
                  parts: [{ text: 'ã‚³ãƒ¼ãƒ’ãƒ¼ã«é–¢ã™ã‚‹è±†çŸ¥è­˜ã‚’1ã¤ã€50æ–‡å­—ä»¥å†…ã§ã€Œã€œãªã®ã ã€å£èª¿ã§æ•™ãˆã¦ã€‚' }]
                }]
              })
            });

            if (!response.ok) {
              throw new Error(`HTTP ${response.status}`);
            }

            const data = await response.json();
            const triviaResponse = data.candidates?.[0]?.content?.parts?.[0]?.text;

            if (triviaResponse) {
              triviaText.textContent = triviaResponse;
            } else {
              triviaText.textContent = DEFAULT_TRIVIA;
            }
          } catch (error) {
            console.error('è±†çŸ¥è­˜ã®å–å¾—ã«å¤±æ•—:', error);
            triviaText.textContent = DEFAULT_TRIVIA;
          }
        }

        // åˆæœŸåŒ–: è±†çŸ¥è­˜ã‚’å–å¾—
        fetchTrivia();

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
        function addMessage(role, text) {
          const messageDiv = document.createElement('div');
          messageDiv.className = `chat-message ${role}`;
          messageDiv.textContent = text;
          chatMessages.appendChild(messageDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
          return messageDiv;
        }

        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
        function removeLoadingMessage() {
          const loadingMsg = chatMessages.querySelector('.chat-message.loading');
          if (loadingMsg) {
            loadingMsg.remove();
          }
        }

        // Gemini APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        async function callGeminiAPI() {
          const response = await fetch('/api/gemini', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              contents: chatHistory,
              systemInstruction: SYSTEM_INSTRUCTION
            })
          });

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
          }

          const data = await response.json();
          return data.candidates?.[0]?.content?.parts?.[0]?.text || 'ã†ã¾ãè¿”äº‹ã§ããªã‹ã£ãŸã®ã ...';
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
        async function sendMessage() {
          const message = chatInput.value.trim();
          if (!message || isSending) return;

          // é€ä¿¡ä¸­çŠ¶æ…‹ã«
          isSending = true;
          chatSendBtn.disabled = true;
          chatInput.disabled = true;

          // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
          addMessage('user', message);
          chatInput.value = '';

          // å±¥æ­´ã«è¿½åŠ 
          chatHistory.push({ role: 'user', parts: [{ text: message }] });

          // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
          const loadingMsg = addMessage('assistant', 'è€ƒãˆä¸­ãªã®ã ...');
          loadingMsg.classList.add('loading');

          try {
            const response = await callGeminiAPI();

            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å‰Šé™¤ã—ã¦å¿œç­”ã‚’è¡¨ç¤º
            removeLoadingMessage();
            addMessage('assistant', response);

            // å±¥æ­´ã«è¿½åŠ 
            chatHistory.push({ role: 'model', parts: [{ text: response }] });
          } catch (error) {
            console.error('APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼:', error);
            removeLoadingMessage();

            addMessage('assistant', 'ã†ã¾ãè¿”äº‹ã§ããªã‹ã£ãŸã®ã ...ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ã»ã—ã„ã®ã ã€‚');
          } finally {
            // é€ä¿¡çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            isSending = false;
            chatSendBtn.disabled = false;
            chatInput.disabled = false;
            chatInput.focus();
          }
        }

        // ãƒãƒ£ãƒƒãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
        function openChatModal() {
          chatModal.classList.add('is-active');
          document.body.style.overflow = 'hidden';
          isChatOpen = true;
          chatInput.focus();
        }

        // ãƒãƒ£ãƒƒãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeChatModal() {
          chatModal.classList.remove('is-active');
          document.body.style.overflow = '';
          isChatOpen = false;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        openChatBtn.addEventListener('click', openChatModal);
        closeChatBtn.addEventListener('click', closeChatModal);

        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        chatModal.addEventListener('click', (e) => {
          if (e.target === chatModal) {
            closeChatModal();
          }
        });

        // ESCã‚­ãƒ¼ã§é–‰ã˜ã‚‹
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && isChatOpen) {
            closeChatModal();
          }
        });

        // é€ä¿¡ãƒœã‚¿ãƒ³
        chatSendBtn.addEventListener('click', sendMessage);

        // Enterã‚­ãƒ¼ã§é€ä¿¡
        chatInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });
      })();
    </script>
  </body>
</html>
