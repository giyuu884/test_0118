# コーヒー豆検索モーダル 設計書

## 目的
- ホーム画面に「コーヒー豆を検索する」ボタンを追加し、モーダルで検索条件を指定できるようにする。
- 検索条件に合致する豆をすべて提示し、該当がない場合は近いものを最低3つ提示する。

## 画面定義
- **ホーム画面**: 既存の「コーヒー豆ビギナーズガイド」ページ。
- **検索画面**: ホーム画面上に表示されるモーダル内の検索UIと検索結果。

## 近さの定義（採用）
- 選択された項目のみで距離を計算する。
- 距離 = 選択された項目の絶対差の合計  
  例）酸味=3、焙煎度=7 を選択 → `|酸味-3| + |焙煎度-7|`
- 距離が小さいほど「近い」とみなす。

## 要件
- ボタンは `評価の目安` の下あたりに配置する。
- モーダル（ポップアップ）で検索UIを表示する。
- 酸味・味の濃さ・焙煎度は 1〜10 で選択できる。
- 3項目すべての選択は必須ではないが、**少なくとも1項目は選択必須**。
- 検索条件に当てはまる豆が存在する場合は、**該当するすべて**を表示する。
- 該当が0件の場合は、**近いものを最低3件**、近い順に表示する。
- 既存カードデザイン（添付画像の形式）を流用し、色と余白を統一する。
- 「戻る」ボタンはモーダルを閉じる。

## 実装方針（段階的）
### Step 1: ボタン配置（UI）
- `評価の目安` の直下に CTA ボタンを追加。
- 既存の配色・角丸に合わせる。

### Step 2: モーダル構造（HTML/CSS）
- モーダル本体、オーバーレイ、閉じる導線（戻る）を用意。
- 以下を配置:
  - 酸味・味の濃さ・焙煎度の 1〜10 ボタン群
  - 検索ボタン、戻るボタン
  - 結果表示エリア（カード形式）

### Step 3: モーダル開閉（JS）
- CTA 押下でモーダルを開く。
- 戻る押下でモーダルを閉じる。

### Step 4: 選択UI（JS）
- 1〜10 ボタンはトグル式（選択/解除）。
- 1項目以上が選択されていない場合は検索できない。

### Step 5: データ抽出
- 既存カードから「酸味・味の濃さ・焙煎度」の値を抽出して配列化。
- 取得情報:
  - 名前、地域タグ、説明、酸味、味の濃さ、焙煎度、メタ情報（精製/焙煎/等級）

### Step 6: 検索ロジック
- 選択された項目すべてに一致する豆を **全件**抽出。
- 0件の場合は距離を計算し、近い順に **最低3件**を抽出。

### Step 7: 表示
- 結果は既存カードUIで表示。
- 既存 CSS 変数（`--accent` 等）を使い統一感を維持。

## 検索条件の扱い
- 酸味・味の濃さ・焙煎度はすべて任意選択。
- **検索時には必ず1つ以上選択済みであること**を検証する。

## 検索結果の扱い
- **一致あり**: 一致した豆をすべて表示。
- **一致なし**: 距離が小さい順に並べ、最低3件表示。

## 例外処理
- 条件未選択時: 検索ボタンで警告表示（例: 「1項目以上選択してください」）。
- 結果が3件未満の場合: 全件表示（データ数が少ない場合の安全策）。
