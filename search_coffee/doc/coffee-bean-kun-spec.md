# コーヒー豆くん 実装設計書（段階的）

## 1. 目的
既存のコーヒー豆ガイドサイトに、AI「コーヒー豆くん」による豆知識表示と会話体験を追加する。  
ホーム画面を開くたびに豆知識を提示する。ユーザーとの会話を通してユーザーの気分に合わせたおすすめ（カフェ/豆/ブレンド）を返す。

---

## 2. UI/UX 要件（確定）
- **配置**: `site-header`最下部
- **表示要素**:  
  - 豆知識表示エリア  
  - 「コーヒー豆くんと会話」ボタン  
- **チャットUI**:  
  - 右側から出るスライド型モーダル  
  - スクロール可能  
  - 履歴はページ内のみ（リロードで消える）
- **デザイン**: 既存トーンに統一（色・余白・フォント）
- **対象**: PC優先

---

## 3. 言語仕様
- **基本は日本語で返答**
- **ユーザー入力が英語のときのみ英語で返答**

---

## 4. AI仕様
- **名称**: コーヒー豆くん（表示上の名前は不要）
- **口調**: 「〜なのだ」口調
- **豆知識**:  
  - コーヒー豆に関連する幅広い雑学  
  - ホーム画面表示時に毎回変わる

---

## 5. 段階的実装フロー

### フェーズ1: UI配置のみ（機能なし）
- `site-header`最下部に  
  - 豆知識エリア  
  - 会話ボタン  
- 右側スライドモーダル（開閉のみ）

**狙い**: デザインとレイアウトの確定

---

### フェーズ2: ローカル疑似AI（APIなし）
- 豆知識はローカル配列からランダム表示  
- 会話は定型テンプレで返答  
- 入力言語を簡易判定  
  - 英語入力→英語テンプレ  
  - それ以外→日本語テンプレ  

**狙い**: UXの基礎完成

---

### フェーズ3: AI API接続（本番化）
- **API候補**: Google Gemini API（無料枠想定）  
- まずはクライアント直叩きで検証  
- 豆知識/会話をAPI生成へ切替  
- システムプロンプトに以下を固定  
  - 「なのだ」口調  
  - 基本は日本語  
  - 英語入力時のみ英語

**狙い**: AI体験の本番化

---

### フェーズ4: UX仕上げ
- 送信中表示  
- エラー時フォールバック（ローカル豆知識へ）  
- スクロールや余白調整  
- PCでの操作性最適化

---

## 6. 想定プロンプト方針（概要）
- 一人称: コーヒー豆くん  
- 口調: 「〜なのだ」  
- 出力言語: 入力が英語なら英語、その他は日本語  
- 豆知識: コーヒー豆に少しでも関連する内容  

---

## 7. 次のアクション
- フェーズ1から着手し、UI配置とモーダル開閉まで実装  
- デザイン確認後、フェーズ2へ進行  
